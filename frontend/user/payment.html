<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Payment - WaterBill NG</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #039ed1;
            --primary-dark: #0a5962;
            --primary-light: rgba(3, 158, 209, 0.1);
            --secondary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --text-light: #ecf0f1;
            --text-dark: #2c3e50;
            --card-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            --gradient-primary: linear-gradient(135deg, #11c0d4 0%, #039ed1 100%);
            --gradient-secondary: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            padding-bottom: 100px;
        }

        /* Header Styling - Hidden on tablet/mobile */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--gradient-secondary);
            color: #fff;
            padding: 15px 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-container img {
            width: 45px;
            height: 45px;
            border-radius: 8px;
        }

        .logo-container h1 {
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: 0.5px;
        }

        .hamburger {
            display: none;
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
            color: white;
            padding: 5px;
        }

        nav {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 6px;
            transition: background 0.3s;
            white-space: nowrap;
        }

        nav a:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100%;
            background: var(--gradient-secondary);
            color: white;
            padding-top: 80px;
            transition: 0.3s;
            z-index: 999;
            box-shadow: 5px 0 25px rgba(0,0,0,0.15);
        }

        .sidebar a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 25px;
            color: white;
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
        }

        .sidebar a:hover {
            background: rgba(255, 255, 255, 0.1);
            padding-left: 30px;
        }

        .sidebar a i {
            width: 20px;
            text-align: center;
        }

        .sidebar.show {
            left: 0;
        }

        /* Overlay for sidebar */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 998;
        }

        .overlay.show {
            display: block;
        }

        /* Payment Container */
        .payment-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 20px;
        }

        /* Page Header */
        .page-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .page-header h1 {
            color: var(--secondary-color);
            margin-bottom: 0.5rem;
            font-size: 2.2rem;
        }

        .page-header p {
            color: #6b7280;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Payment Type Toggle */
        .payment-type-toggle {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .toggle-option {
            flex: 1;
            text-align: center;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: #6b7280;
        }

        .toggle-option.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 4px 15px rgba(3, 158, 209, 0.3);
        }

        /* Payment Card */
        .payment-card {
            background: white;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            margin-bottom: 30px;
        }

        .payment-card-header {
            padding: 25px 30px;
            border-bottom: 1px solid #f0f4ff;
            background: linear-gradient(135deg, var(--primary-50) 0%, white 100%);
        }

        .payment-card-header h2 {
            color: var(--secondary-color);
            margin-bottom: 8px;
            font-size: 1.6rem;
        }

        .payment-card-header p {
            color: #6b7280;
            margin: 0;
        }

        .payment-card-body {
            padding: 30px;
        }

        /* Account Info */
        .account-info {
            background: var(--primary-light);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(3, 158, 209, 0.2);
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(3, 158, 209, 0.1);
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            color: var(--secondary-color);
            font-weight: 600;
        }

        .info-value {
            color: var(--primary-dark);
            font-weight: 700;
        }

        /* Payment Options */
        .payment-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .payment-option {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 25px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .payment-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .payment-option.selected {
            border-color: var(--primary-color);
            background: var(--primary-light);
        }

        .payment-option i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: inline-flex;
            width: 70px;
            height: 70px;
            background: var(--primary-light);
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .payment-option:hover i {
            background: var(--primary-color);
            color: white;
            transform: scale(1.1);
        }

        .payment-option h3 {
            margin: 0 0 10px;
            color: var(--secondary-color);
            font-size: 1.3rem;
        }

        .payment-option p {
            color: #6b7280;
            margin: 0;
            font-size: 0.95rem;
        }

        /* Payment Forms */
        .payment-form {
            margin-top: 30px;
        }

        .form-section {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-color);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(3, 158, 209, 0.1);
            outline: none;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            font-weight: 600;
            font-size: 1rem;
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            text-align: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 6px rgba(3, 158, 209, 0.2);
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(3, 158, 209, 0.3);
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }

        /* Payment Details */
        .payment-details {
            background: var(--primary-light);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(3, 158, 209, 0.2);
        }

        .payment-details h4 {
            margin-top: 0;
            color: var(--secondary-color);
            border-bottom: 1px solid rgba(3, 158, 209, 0.3);
            padding-bottom: 12px;
            margin-bottom: 15px;
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .file-upload:hover, .file-upload.highlight {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
        }
        
        .file-upload-label {
            display: block;
            padding: 10px;
            cursor: pointer;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .file-input {
            display: none;
        }

        /* Alerts */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            display: flex;
            align-items: flex-start;
        }
        
        .alert i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .alert-info {
            background-color: rgba(59, 130, 246, 0.1);
            color: #1e40af;
            border-color: #93c5fd;
        }
        
        .alert-success {
            background-color: rgba(34, 197, 94, 0.1);
            color: #166534;
            border-color: #86efac;
        }
        
        .alert-warning {
            background-color: rgba(245, 158, 11, 0.1);
            color: #854d0e;
            border-color: #fcd34d;
        }
        
        .alert-danger {
            background-color: rgba(239, 68, 68, 0.1);
            color: #991b1b;
            border-color: #fca5a5;
        }

        /* Amount Input */
        .amount-input {
            position: relative;
        }

        .amount-input .currency {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-weight: 600;
            color: var(--primary-color);
        }

        .amount-input .form-control {
            padding-left: 40px;
        }

        /* Payment Summary */
        .payment-summary {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-top: 30px;
            border: 1px solid #e5e7eb;
            box-shadow: var(--card-shadow);
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .summary-item:last-child {
            border-bottom: none;
        }
        
        .summary-label {
            color: #6b7280;
        }
        
        .summary-value {
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .summary-total {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #e5e7eb;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .summary-total .summary-value {
            font-size: 1.25rem;
            color: var(--primary-color);
        }

        /* ==================== */
        /* REDESIGNED MOBILE FOOTER - Enhanced */
        /* ==================== */
        .mobile-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.1);
            padding: 12px 0;
            z-index: 1000;
            display: flex;
            justify-content: space-around;
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .footer-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #6b7280;
            transition: all 0.3s ease;
            position: relative;
            flex: 1;
            max-width: 70px;
            padding: 5px 0;
        }
        
        .footer-link i {
            font-size: 1.2rem;
            margin-bottom: 4px;
            transition: all 0.3s ease;
        }
        
        .footer-link span {
            font-size: 0.65rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
            line-height: 1.1;
        }
        
        .footer-link.active,
        .footer-link:hover {
            color: var(--primary-color);
        }
        
        .footer-link.active i,
        .footer-link:hover i {
            transform: scale(1.1);
        }
        
        .footer-link.active::after {
            content: '';
            position: absolute;
            bottom: -12px;
            width: 5px;
            height: 5px;
            background: var(--primary-color);
            border-radius: 50%;
        }

        /* Mobile Dropdown Menu */
        .mobile-dropdown {
            position: fixed;
            bottom: 70px;
            left: 10px;
            right: 10px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.15);
            padding: 10px 0;
            z-index: 1001;
            display: none;
        }

        .mobile-dropdown.show {
            display: block;
            animation: slideUp 0.3s ease;
        }

        .mobile-dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            text-decoration: none;
            color: #333;
            transition: background 0.2s;
        }

        .mobile-dropdown-item:hover {
            background: var(--primary-light);
            color: var(--primary-color);
        }

        .mobile-dropdown-item i {
            width: 20px;
            text-align: center;
            font-size: 1rem;
        }

        .mobile-dropdown-item span {
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            header {
                display: none;
            }
            
            .payment-container {
                padding: 0 15px;
            }
            
            .payment-card-body {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .payment-options {
                grid-template-columns: 1fr;
            }
            
            .page-header h1 {
                font-size: 1.8rem;
            }
            
            .page-header p {
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .payment-container {
                padding: 0 10px;
            }
            
            .payment-card-header {
                padding: 20px;
            }
            
            .payment-card-body {
                padding: 15px;
            }
            
            .payment-details {
                padding: 20px;
            }
            
            .file-upload {
                padding: 20px;
            }
        }

        /* Header responsive adjustments */
        @media (max-width: 1200px) {
            header {
                padding: 15px 20px;
            }
            
            nav a {
                font-size: 13px;
                padding: 6px 12px;
            }
        }

        @media (max-width: 1100px) {
            nav {
                gap: 5px;
                flex-wrap: wrap;
                    justify-content: flex-end;
            }
            
            nav a {
                font-size: 12px;
                padding: 5px 10px;
            }
        }

        /* Show header only on desktop */
        @media (min-width: 993px) {
            .mobile-footer {
                display: none;
            }
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header - Hidden on tablet/mobile -->
    <header>
        <div class="logo-container">
            <img src="../assets/logo.png" alt="WaterBill NG">
            <h1>WaterBill NG</h1>
        </div>
        
        <button class="hamburger" id="menu-btn">
            <i class="fas fa-bars"></i>
        </button>
        
        <nav>
            <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
            <a href="payment.html"><i class="fas fa-credit-card"></i> Payments</a>
            <a href="history.html"><i class="fas fa-history"></i> History</a>
            <a href="../includes/communityperformance.php"><i class="fas fa-chart-line"></i> Performance</a>
            <a href="profile.html"><i class="fas fa-user"></i> Profile</a>
            <a href="#" onclick="logout()" style="color: #ff6b6b;"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </nav>
    </header>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
        <a href="payment.html"><i class="fas fa-credit-card"></i> Make Payment</a>
        <a href="history.html"><i class="fas fa-history"></i> Payment History</a>
        <a href="../includes/communityperformance.php"><i class="fas fa-chart-line"></i> Community Performance</a>
        <a href="report-fault.html"><i class="fas fa-exclamation-triangle"></i> Report Fault</a>
        <a href="profile.html"><i class="fas fa-user"></i> Profile</a>
        <a href="notifications.html"><i class="fas fa-bell"></i> Notifications</a>
        <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>
    
    <div class="overlay" id="overlay"></div>

    <!-- Main Content -->
    <div class="payment-container">
        <div class="page-header">
            <h1>Make a Payment</h1>
            <p>Select payment type and choose your preferred payment method</p>
        </div>

        <!-- Payment Type Toggle -->
        <div class="payment-type-toggle">
            <div class="toggle-option active" id="recharge-toggle" onclick="selectPaymentType('recharge')">
                <i class="fas fa-bolt"></i> Water Recharge
            </div>
            <div class="toggle-option" id="maintenance-toggle" onclick="selectPaymentType('maintenance')">
                <i class="fas fa-tools"></i> Maintenance Fee
            </div>
        </div>

        <!-- Payment Card -->
        <div class="payment-card">
            <div class="payment-card-header">
                <h2>Payment Details</h2>
                <p>Select your preferred payment method and complete the transaction</p>
            </div>
            <div class="payment-card-body">
                <!-- Account Information -->
                <div class="account-info">
                    <div class="info-item">
                        <span class="info-label">Meter Number:</span>
                        <span class="info-value">45056820942</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Account Name:</span>
                        <span class="info-value">Bamigbaye Sunday</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Payment Type:</span>
                        <span class="info-value" id="current-payment-type">Water Recharge</span>
                    </div>
                </div>

                <!-- Payment Amount Input -->
                <div class="form-group">
                    <label class="form-label">Amount to Pay (₦)</label>
                    <div class="amount-input">
                        <span class="currency">₦</span>
                        <input type="number" class="form-control" id="payment-amount" placeholder="Enter amount" min="1" value="5000">
                    </div>
                    <small class="text-muted" id="amount-description">Enter the amount you wish to recharge</small>
                </div>

                <!-- Payment Options -->
                <h3 style="margin-bottom: 15px;">Select Payment Method</h3>
                <div class="payment-options">
                    <div class="payment-option" data-method="paystack" onclick="selectPaymentMethod('paystack')">
                        <i class="fas fa-credit-card"></i>
                        <h3>Paystack</h3>
                        <p>Pay with card, bank or USSD</p>
                    </div>
                    <div class="payment-option" data-method="bank-transfer" onclick="selectPaymentMethod('bank-transfer')">
                        <i class="fas fa-university"></i>
                        <h3>Bank Transfer</h3>
                        <p>Transfer directly from your bank</p>
                    </div>
                    <div class="payment-option" data-method="opay" onclick="selectPaymentMethod('opay')">
                        <i class="fas fa-mobile-alt"></i>
                        <h3>OPay Transfer</h3>
                        <p>Transfer via OPay app</p>
                    </div>
                    <div class="payment-option" data-method="receipt" onclick="selectPaymentMethod('receipt')">
                        <i class="fas fa-receipt"></i>
                        <h3>Upload Receipt</h3>
                        <p>Upload PDF receipt for verification</p>
                    </div>
                    <div class="payment-option" data-method="cash" onclick="selectPaymentMethod('cash')">
                        <i class="fas fa-money-bill-wave"></i>
                        <h3>Cash Payment</h3>
                        <p>Pay with cash to an admin</p>
                    </div>
                </div>

                <!-- Payment Forms -->
                <div class="payment-form">
                    <!-- Paystack Form -->
                    <div id="paystack-form" class="form-section">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            Paystack payment integration is coming soon. Please check back later or use another payment method.
                        </div>
                        <button class="btn btn-primary btn-block" onclick="showComingSoon('Paystack')">
                            <i class="fas fa-credit-card"></i> Pay with Paystack
                        </button>
                    </div>

                    <!-- Bank Transfer Form -->
                    <div id="bank-transfer-form" class="form-section">
                        <div class="payment-details">
                            <h4>Bank Transfer Instructions</h4>
                            <p>Please transfer the payment to the following account:</p>
                            <div class="bank-details">
                                <p><strong>Bank Name:</strong> Access Bank</p>
                                <p><strong>Account Name:</strong> WaterBill NG</p>
                                <p><strong>Account Number:</strong> 0123456789</p>
                                <p><strong>Reference:</strong> <span id="user-reference">WD-R1234567</span></p>
                                <p class="text-muted">Use the reference above for your transfer</p>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-block" onclick="openBankApp()">
                            <i class="fas fa-external-link-alt"></i> Open Bank App
                        </button>
                        <button class="btn btn-primary btn-block" style="margin-top: 10px; background: #6b7280;" onclick="confirmBankTransfer()">
                            <i class="fas fa-check-circle"></i> I've Made the Transfer
                        </button>
                    </div>

                    <!-- OPay Transfer Form -->
                    <div id="opay-form" class="form-section">
                        <div class="payment-details">
                            <h4>OPay Transfer Instructions</h4>
                            <p>Please transfer the payment to the following OPay account:</p>
                            <div class="bank-details">
                                <p><strong>OPay Name:</strong> WaterBill NG</p>
                                <p><strong>OPay Number:</strong> 0803 123 4567</p>
                                <p><strong>Reference:</strong> <span id="opay-reference">WD-R1234567</span></p>
                                <p class="text-muted">Use the reference above for your transfer</p>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-block" onclick="openOpayApp()">
                            <i class="fas fa-external-link-alt"></i> Open OPay App
                        </button>
                        <button class="btn btn-primary btn-block" style="margin-top: 10px; background: #6b7280;" onclick="confirmOpayTransfer()">
                            <i class="fas fa-check-circle"></i> I've Made the Transfer
                        </button>
                    </div>

                    <!-- Receipt Upload Form -->
                    <div id="receipt-form" class="form-section">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            Please upload a clear copy of your bank transfer receipt (PDF only) showing the transaction details.
                        </div>
                        <div class="form-group">
                            <label class="form-label">Upload Receipt (PDF only)</label>
                            <div class="file-upload" id="fileUploadArea">
                                <input type="file" id="receiptFile" class="file-input" accept=".pdf">
                                <div class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <span>Choose PDF file or drag & drop</span>
                                </div>
                                <div id="file-name" class="mt-2 text-muted">No file selected</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Amount Paid (₦)</label>
                            <input type="number" id="receiptAmount" class="form-control" placeholder="Enter amount" min="1" value="5000">
                            <small class="text-muted">This amount will sync with the payment summary</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Transaction Date</label>
                            <input type="date" id="transactionDate" class="form-control" value="">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Bank Name</label>
                            <select id="bankName" class="form-control">
                                <!-- Banks will be populated by JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Transaction Reference</label>
                            <input type="text" id="transactionRef" class="form-control" placeholder="WD-R1234567" readonly>
                            <small class="text-muted">Auto-generated reference number</small>
                        </div>
                        <button type="button" class="btn btn-primary btn-block" onclick="submitReceipt()">
                            <i class="fas fa-upload"></i> Submit Receipt for Verification
                        </button>
                    </div>

                    <!-- Cash Payment Form -->
                    <div id="cash-form" class="form-section">
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            For cash payments, please meet one of our administrators with the exact amount you wish to pay.
                        </div>
                        <div class="payment-details">
                            <h4>Cash Payment Instructions</h4>
                            <p>To complete your cash payment:</p>
                            <ol style="text-align: left; margin-left: 20px; margin-top: 10px;">
                                <li>Visit our office during working hours (Mon-Fri, 9am-5pm)</li>
                                <li>Bring the exact amount you wish to pay</li>
                                <li>Provide your meter number: <strong>45056820942</strong></li>
                                <li>You will receive a receipt after payment</li>
                            </ol>
                            <p style="margin-top: 15px;"><strong>Office Address:</strong> 123 WaterBill Street, Lagos, Nigeria</p>
                            <p><strong>Contact:</strong> 0803 123 4567</p>
                        </div>
                        <button class="btn btn-primary btn-block" onclick="confirmCashPayment()">
                            <i class="fas fa-check-circle"></i> I Understand
                        </button>
                    </div>
                </div>

                <!-- Payment Summary -->
                <div class="payment-summary">
                    <h4>Payment Summary</h4>
                    <div class="summary-item">
                        <span class="summary-label">Meter Number</span>
                        <span class="summary-value">45056820942</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Account Name</span>
                        <span class="summary-value">Bamigbaye Sunday</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Payment Type</span>
                        <span class="summary-value" id="summary-payment-type">Water Recharge</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Amount</span>
                        <span class="summary-value" id="summary-amount">₦5,000.00</span>
                    </div>
                    <div class="summary-item summary-total">
                        <span>Total Amount</span>
                        <span id="summary-total">₦5,000.00</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== -->
    <!-- REDESIGNED MOBILE FOOTER - Primary Navigation -->
    <!-- ==================== -->
    <footer class="mobile-footer" role="navigation" aria-label="Primary">
        <a href="dashboard.html" class="footer-link">
            <i class="fas fa-home"></i>
            <span>Dashboard</span>
        </a>
        <a href="payment.html" class="footer-link active">
            <i class="fas fa-wallet"></i>
            <span>Payments</span>
        </a>
        <a href="history.html" class="footer-link">
            <i class="fas fa-history"></i>
            <span>History</span>
        </a>
        <a href="../includes/communityperformance.php" class="footer-link">
            <i class="fas fa-chart-line"></i>
            <span>Performance</span>
        </a>
        <a href="#" class="footer-link" id="more-menu">
            <i class="fas fa-ellipsis-h"></i>
            <span>More</span>
        </a>
    </footer>

    <!-- Mobile Dropdown Menu -->
    <div class="mobile-dropdown" id="mobile-dropdown">
        <a href="profile.html" class="mobile-dropdown-item">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </a>
        <a href="report-fault.html" class="mobile-dropdown-item">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Report Fault</span>
        </a>
        <a href="notifications.html" class="mobile-dropdown-item">
            <i class="fas fa-bell"></i>
            <span>Notifications</span>
        </a>
        <a href="#" class="mobile-dropdown-item" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
        </a>
    </div>
    <!-- ==================== -->
    <!-- END REDESIGNED MOBILE FOOTER -->
    <!-- ==================== -->

    <script>
        // Nigerian banks list
        const nigerianBanks = [
            "Access Bank",
            "Citibank Nigeria",
            "Ecobank Nigeria",
            "Fidelity Bank",
            "First Bank of Nigeria",
            "First City Monument Bank (FCMB)",
            "Globus Bank",
            "Guaranty Trust Bank (GTB)",
            "Heritage Bank",
            "Jaiz Bank",
            "Keystone Bank",
            "Polaris Bank",
            "Providus Bank",
            "Stanbic IBTC Bank",
            "Standard Chartered Bank Nigeria",
            "Sterling Bank",
            "Suntrust Bank",
            "Union Bank of Nigeria",
            "United Bank for Africa (UBA)",
            "Unity Bank",
            "Wema Bank",
            "Zenith Bank"
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Set default payment type
            selectPaymentType('recharge');
            
            // Set default payment method
            selectPaymentMethod('paystack');
            
            // Set today's date as default for transaction date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('transactionDate').value = today;
            document.getElementById('transactionDate').setAttribute('max', today);
            
            // Initialize banks dropdown
            initializeBanksDropdown();
            
            // Generate initial reference number
            updateReferenceNumber();
            
            // Update payment summary when amount changes
            document.getElementById('payment-amount').addEventListener('input', updatePaymentSummary);
            document.getElementById('receiptAmount').addEventListener('input', syncReceiptAmount);
            
            // Setup file upload handling
            setupFileUpload();
            
            // Setup sidebar
            setupSidebar();
            
            // Setup mobile menu
            setupMobileMenu();
        });

        // Setup mobile dropdown menu
        function setupMobileMenu() {
            const moreMenu = document.getElementById('more-menu');
            const dropdown = document.getElementById('mobile-dropdown');
            const overlay = document.getElementById('overlay');

            if (moreMenu && dropdown) {
                moreMenu.addEventListener('click', function(e) {
                    e.preventDefault();
                    dropdown.classList.toggle('show');
                    
                    if (overlay) {
                        if (dropdown.classList.contains('show')) {
                            overlay.classList.add('show');
                        } else {
                            overlay.classList.remove('show');
                        }
                    }
                });

                // Close dropdown when clicking overlay
                if (overlay) {
                    overlay.addEventListener('click', function() {
                        dropdown.classList.remove('show');
                        overlay.classList.remove('show');
                    });
                }

                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!moreMenu.contains(e.target) && !dropdown.contains(e.target)) {
                        dropdown.classList.remove('show');
                        if (overlay) {
                            overlay.classList.remove('show');
                        }
                    }
                });
            }
        }

        // Initialize banks dropdown
        function initializeBanksDropdown() {
            const bankSelect = document.getElementById('bankName');
            if (!bankSelect) return;
            
            // Clear existing options
            bankSelect.innerHTML = '';
            
            // Add default option
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'Select your bank';
            defaultOption.disabled = true;
            defaultOption.selected = true;
            bankSelect.appendChild(defaultOption);
            
            // Add all banks
            nigerianBanks.forEach(bank => {
                const option = document.createElement('option');
                option.value = bank;
                option.textContent = bank;
                bankSelect.appendChild(option);
            });
        }

        // Generate random reference number in format "WD-R1234567"
        function generateReferenceNumber() {
            const prefix = "WD-R";
            const randomNum = Math.floor(1000000 + Math.random() * 9000000); // 7-digit random number
            return prefix + randomNum;
        }

        // Update reference number in all relevant fields
        function updateReferenceNumber() {
            const reference = generateReferenceNumber();
            
            // Update bank transfer reference
            const bankReference = document.getElementById('user-reference');
            if (bankReference) bankReference.textContent = reference;
            
            // Update OPay reference
            const opayReference = document.getElementById('opay-reference');
            if (opayReference) opayReference.textContent = reference;
            
            // Update receipt form reference
            const receiptReference = document.getElementById('transactionRef');
            if (receiptReference) receiptReference.value = reference;
            
            return reference;
        }

        // Select payment type (recharge/maintenance)
        function selectPaymentType(type) {
            // Update toggle buttons
            document.getElementById('recharge-toggle').classList.toggle('active', type === 'recharge');
            document.getElementById('maintenance-toggle').classList.toggle('active', type === 'maintenance');
            
            // Update payment type display
            const paymentTypeText = type === 'recharge' ? 'Water Recharge' : 'Maintenance Fee';
            document.getElementById('current-payment-type').textContent = paymentTypeText;
            document.getElementById('summary-payment-type').textContent = paymentTypeText;
            
            // Update amount description
            const description = type === 'recharge' 
                ? 'Enter the amount you wish to recharge' 
                : 'Enter the maintenance fee amount';
            document.getElementById('amount-description').textContent = description;
            
            // Update default amount based on type
            const defaultAmount = type === 'recharge' ? 5000 : 2000;
            document.getElementById('payment-amount').value = defaultAmount;
            document.getElementById('receiptAmount').value = defaultAmount;
            
            // Generate new reference number when payment type changes
            updateReferenceNumber();
            
            // Update summary
            updatePaymentSummary();
        }

        // Select payment method
        function selectPaymentMethod(method) {
            // Remove selected class from all options
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            const selectedOption = document.querySelector(`[data-method="${method}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
            
            // Hide all form sections
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected form section
            const formSection = document.getElementById(`${method}-form`);
            if (formSection) {
                formSection.classList.add('active');
            }
            
            // Generate new reference number when payment method changes
            if (method === 'bank-transfer' || method === 'opay' || method === 'receipt') {
                updateReferenceNumber();
            }
        }

        // Update payment summary
        function updatePaymentSummary() {
            const amount = document.getElementById('payment-amount').value;
            const formattedAmount = new Intl.NumberFormat('en-NG', {
                style: 'currency',
                currency: 'NGN'
            }).format(amount);
            
            document.getElementById('summary-amount').textContent = formattedAmount;
            document.getElementById('summary-total').textContent = formattedAmount;
            
            // Sync receipt amount with main amount
            document.getElementById('receiptAmount').value = amount;
        }

        // Sync receipt amount with main amount
        function syncReceiptAmount() {
            const receiptAmount = document.getElementById('receiptAmount').value;
            document.getElementById('payment-amount').value = receiptAmount;
            updatePaymentSummary();
        }

        // Show coming soon notification
        function showComingSoon(method) {
            alert(`${method} payment is coming soon. Please try another payment method.`);
        }

        // Open bank app (attempt to deep link)
        function openBankApp() {
            const amount = document.getElementById('payment-amount').value;
            const reference = document.getElementById('user-reference').textContent;
            
            // Show payment details for manual transfer
            const bankDetails = `
Bank Transfer Details:

Bank Name: Access Bank
Account Name: WaterBill NG  
Account Number: 0123456789
Amount: ₦${parseFloat(amount).toLocaleString()}
Reference: ${reference}

Please copy these details and make the transfer from your bank app.
            `;
            
            alert(bankDetails);
        }

        // Confirm bank transfer
        function confirmBankTransfer() {
            const amount = document.getElementById('payment-amount').value;
            const paymentType = document.getElementById('current-payment-type').textContent;
            const reference = document.getElementById('user-reference').textContent;
            
            const confirmationMessage = `
Please confirm your bank transfer:

Amount: ₦${parseFloat(amount).toLocaleString()}
Payment Type: ${paymentType}
Reference: ${reference}

Have you completed this transfer?
            `;
            
            if (confirm(confirmationMessage)) {
                // In a real app, this would send a notification to admin for verification
                alert('Thank you! Your payment is being verified. You will receive a confirmation once verified.');
                
                // Here you would typically send the data to your backend
                const paymentData = {
                    meterNumber: '45056820942',
                    accountName: 'Bamigbaye Sunday',
                    paymentType: paymentType,
                    amount: amount,
                    method: 'bank-transfer',
                    reference: reference,
                    status: 'pending_verification',
                    timestamp: new Date().toISOString()
                };
                
                console.log('Payment data:', paymentData);
                // sendPaymentToBackend(paymentData);
                
                // Generate new reference for next payment
                updateReferenceNumber();
            }
        }

        // Open OPay app (attempt to deep link)
        function openOpayApp() {
            const amount = document.getElementById('payment-amount').value;
            const reference = document.getElementById('opay-reference').textContent;
            
            // Show payment details for manual transfer
            const opayDetails = `
OPay Transfer Details:

OPay Name: WaterBill NG
OPay Number: 0803 123 4567
Amount: ₦${parseFloat(amount).toLocaleString()}
Reference: ${reference}

Please copy these details and make the transfer from your OPay app.
            `;
            
            alert(opayDetails);
        }

        // Confirm OPay transfer
        function confirmOpayTransfer() {
            const amount = document.getElementById('payment-amount').value;
            const paymentType = document.getElementById('current-payment-type').textContent;
            const reference = document.getElementById('opay-reference').textContent;
            
            const confirmationMessage = `
Please confirm your OPay transfer:

Amount: ₦${parseFloat(amount).toLocaleString()}
Payment Type: ${paymentType}
Reference: ${reference}

Have you completed this transfer?
            `;
            
            if (confirm(confirmationMessage)) {
                // In a real app, this would send a notification to admin for verification
                alert('Thank you! Your payment is being verified. You will receive a confirmation once verified.');
                
                // Here you would typically send the data to your backend
                const paymentData = {
                    meterNumber: '45056820942',
                    accountName: 'Bamigbaye Sunday',
                    paymentType: paymentType,
                    amount: amount,
                    method: 'opay',
                    reference: reference,
                    status: 'pending_verification',
                    timestamp: new Date().toISOString()
                };
                
                console.log('Payment data:', paymentData);
                // sendPaymentToBackend(paymentData);
                
                // Generate new reference for next payment
                updateReferenceNumber();
            }
        }

        // Submit receipt for verification
        function submitReceipt() {
            const fileInput = document.getElementById('receiptFile');
            const amount = document.getElementById('receiptAmount').value;
            const date = document.getElementById('transactionDate').value;
            const bank = document.getElementById('bankName').value;
            const reference = document.getElementById('transactionRef').value;
            const paymentType = document.getElementById('current-payment-type').textContent;
            
            // Basic validation
            if (!fileInput.files[0]) {
                alert('Please select a receipt file to upload');
                return;
            }
            
            // Validate file type (PDF only)
            const file = fileInput.files[0];
            if (file.type !== 'application/pdf') {
                alert('Please upload a PDF file only');
                return;
            }
            
            if (!amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (!date) {
                alert('Please select the transaction date');
                return;
            }
            
            if (!bank || bank === '') {
                alert('Please select your bank');
                return;
            }
            
            if (!reference || reference.trim() === '') {
                alert('Please enter the transaction reference');
                return;
            }
            
            // Validate file size (5MB max)
            if (file.size > 5 * 1024 * 1024) {
                alert('File size must be less than 5MB');
                return;
            }
            
            // Validate date is not in the future
            const today = new Date().toISOString().split('T')[0];
            if (date > today) {
                alert('Transaction date cannot be in the future');
                return;
            }
            
            // Show loading state
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<span class="spinner"></span> Uploading...';
            button.disabled = true;
            
            // Create FormData for file upload
            const formData = new FormData();
            formData.append('receipt', file);
            formData.append('amount', amount);
            formData.append('transactionDate', date);
            formData.append('bankName', bank);
            formData.append('transactionRef', reference);
            formData.append('paymentType', paymentType);
            
            // Simulate file upload (replace with actual API call)
            simulateFileUpload(formData)
                .then(result => {
                    // Reset form
                    resetReceiptForm();
                    
                    // Show success message
                    showUploadSuccess(amount, paymentType, result.data.reference);
                    
                    // Generate new reference for next payment
                    updateReferenceNumber();
                })
                .catch(error => {
                    console.error('Upload error:', error);
                    alert('Upload failed: ' + error.message);
                })
                .finally(() => {
                    // Reset button
                    button.innerHTML = originalText;
                    button.disabled = false;
                });
        }
        
        // Simulate file upload to backend
        function simulateFileUpload(formData) {
            return new Promise((resolve, reject) => {
                // Simulate network delay
                setTimeout(() => {
                    // For demo purposes, simulate successful upload
                    const file = formData.get('receipt');
                    const paymentData = {
                        success: true,
                        message: 'Receipt uploaded successfully',
                        data: {
                            fileName: file.name,
                            fileSize: (file.size / 1024).toFixed(2) + ' KB',
                            amount: formData.get('amount'),
                            transactionDate: formData.get('transactionDate'),
                            bankName: formData.get('bankName'),
                            transactionRef: formData.get('transactionRef'),
                            paymentType: formData.get('paymentType'),
                            uploadTime: new Date().toISOString(),
                            reference: formData.get('transactionRef')
                        }
                    };
                    
                    console.log('Simulated upload success:', paymentData);
                    resolve(paymentData);
                }, 2000);
            });
        }

        // Reset receipt form after successful upload
        function resetReceiptForm() {
            document.getElementById('receiptFile').value = '';
            document.getElementById('bankName').value = '';
            document.getElementById('transactionRef').value = updateReferenceNumber();
            document.getElementById('file-name').textContent = 'No file selected';
            document.getElementById('fileUploadArea').classList.remove('highlight');
            
            // Set today's date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('transactionDate').value = today;
        }

        // Show upload success message
        function showUploadSuccess(amount, paymentType, reference) {
            const successMessage = `
✅ Receipt Uploaded Successfully!

Amount: ₦${parseFloat(amount).toLocaleString()}
Type: ${paymentType}
Reference: ${reference}
Status: Pending Verification

Your receipt has been submitted for verification. 
You will receive a confirmation within 24 hours.

Thank you for your payment!
            `;
            
            alert(successMessage);
        }

        // Set up file upload handling
        function setupFileUpload() {
            const fileInput = document.getElementById('receiptFile');
            const fileUploadArea = document.getElementById('fileUploadArea');
            const fileName = document.getElementById('file-name');
            
            if (!fileInput || !fileUploadArea || !fileName) {
                console.error('File upload elements not found');
                return;
            }
            
            // Handle click on upload area
            fileUploadArea.addEventListener('click', function(e) {
                if (e.target !== fileInput) {
                    fileInput.click();
                }
            });
            
            // Handle file selection
            fileInput.addEventListener('change', function(e) {
                const selectedFile = e.target.files[0];
                if (selectedFile) {
                    // Validate file type
                    if (selectedFile.type === 'application/pdf') {
                        fileName.textContent = `Selected: ${selectedFile.name} (${(selectedFile.size / 1024).toFixed(2)} KB)`;
                        fileName.style.color = '#27ae60';
                        fileUploadArea.style.borderColor = '#27ae60';
                    } else {
                        fileName.textContent = 'Error: Please select a PDF file only';
                        fileName.style.color = '#e74c3c';
                        fileUploadArea.style.borderColor = '#e74c3c';
                        fileInput.value = ''; // Clear invalid file
                    }
                } else {
                    fileName.textContent = 'No file selected';
                    fileName.style.color = '#6b7280';
                    fileUploadArea.style.borderColor = '#d1d5db';
                }
            });
            
            // Handle drag and drop
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                fileUploadArea.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                fileUploadArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                fileUploadArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                fileUploadArea.classList.add('highlight');
                fileUploadArea.style.borderColor = '#039ed1';
                fileUploadArea.style.backgroundColor = 'rgba(3, 158, 209, 0.05)';
            }
            
            function unhighlight() {
                fileUploadArea.classList.remove('highlight');
                fileUploadArea.style.borderColor = '#d1d5db';
                fileUploadArea.style.backgroundColor = '';
            }
            
            fileUploadArea.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length) {
                    const droppedFile = files[0];
                    
                    // Validate dropped file
                    if (droppedFile.type === 'application/pdf') {
                        fileInput.files = files;
                        fileName.textContent = `Selected: ${droppedFile.name} (${(droppedFile.size / 1024).toFixed(2)} KB)`;
                        fileName.style.color = '#27ae60';
                        fileUploadArea.style.borderColor = '#27ae60';
                    } else {
                        fileName.textContent = 'Error: Please drop a PDF file only';
                        fileName.style.color = '#e74c3c';
                        fileUploadArea.style.borderColor = '#e74c3c';
                    }
                }
                
                unhighlight();
            }
        }

        // Confirm cash payment
        function confirmCashPayment() {
            const amount = document.getElementById('payment-amount').value;
            const paymentType = document.getElementById('current-payment-type').textContent;
            const reference = generateReferenceNumber();
            
            alert(`Please visit our office with ₦${amount} in cash for ${paymentType}.\n\nReference: ${reference}\n\nOur address and contact details are shown above.`);
            
            // In a real app, you might record this intention to pay with cash
            const paymentData = {
                meterNumber: '45056820942',
                accountName: 'Bamigbaye Sunday',
                paymentType: paymentType,
                amount: amount,
                method: 'cash',
                reference: reference,
                status: 'pending',
                timestamp: new Date().toISOString()
            };
            
            console.log('Cash payment intent:', paymentData);
            // sendPaymentToBackend(paymentData);
        }

        // Setup sidebar
        function setupSidebar() {
            const menuBtn = document.getElementById('menu-btn');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (menuBtn && sidebar && overlay) {
                menuBtn.addEventListener('click', () => {
                    sidebar.classList.toggle('show');
                    overlay.classList.toggle('show');
                });
                
                overlay.addEventListener('click', () => {
                    sidebar.classList.remove('show');
                    overlay.classList.remove('show');
                });
            }
        }

        // Logout function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // In a real app, you would call your logout API
                window.location.href = '../auth/login.html';
            }
        }
    </script>
</body>
</html>